<% #main %>
<h1><% response.title %></h1>
<div class='uk-article-meta'><% layout.skin $HopObject#meta %></div>
<div class='uk-margin-top'>
   <% layout.link skins <% gettext Skins %> %>
   <% layout.link images <% gettext Images %> prefix=' | ' %>
   <% layout.link import <% gettext Import %> prefix=' | ' %>
   <% layout.link export <% gettext Export %> prefix=' | ' %>
</div>
<% site.skin $Site#noscript %>
<form class='uk-margin-top uk-form uk-form-stacked' id='prefs' method='post'>
   <div class='uk-form-row'>
      <div class='uk-form-label'>
         <% gettext 'Show Controls' %>
      </div>
      <div class='uk-form-controls'>
         <input id='sandbox' name='sandbox' type='checkbox' <% if <% layout.sandbox %> is true then checked %>>
         <label for='sandbox'><% gettext enabled %></label>
      </div>
   </div>
   <div class='uk-form-row uk-margin-top'>
      <fieldset class='av-values'>
         <legend>
            <% gettext 'Variables' %>
         </legend>
         <div class='uk-grid'>
            <% layout.values %>
         </div>
         <div id='av-add-value' class='uk-margin-bottom uk-hidden'>
            <div class='uk-form-label'>&#160;</div>
            <a href='javascript:' class='uk-icon-button uk-icon-plus uk-text-middle'></a>
         </div>
      </fieldset>
   </div>
   <div class='uk-margin-top'>
      <button class='uk-button uk-button-primary' type='submit' id='submit' name='save' value='1'>
         <% gettext Save %>
      </button>
      <% layout.link reset <% gettext Reset %> class='uk-button' %>
      <a href='..' class='uk-button uk-button-link'><% gettext Cancel %></a>
   </div>
</form>
<script type='text/javascript'>
   $('.av-values').on('mouseover', '.av-value-row', function () {
      $(this).find('.av-value-remove').removeClass('uk-hidden');
   }).on('mouseout', '.av-value-row', function () {
      $(this).find('.av-value-remove').addClass('uk-hidden');
   }).on('click', '.av-value-remove', function () {
      $(this).parents('.av-value-row').remove();
   });

   $('#av-add-value').removeClass('uk-hidden')
      .find('a')
      .on('click', function (event) {
      event.preventDefault();
      var name = prompt('<% gettext "Please enter the name of the new value:" %>');
      if (name) {
         var key = 'av-value ' + name;
         var valueRow = $('.av-value-row').eq(0).clone().removeClass('uk-hidden');
         valueRow.find('.av-value-title').html(name);
         valueRow.find('.uk-form-controls input').attr({
            id: key.replace(new RegExp(' ', 'g'), '-'),
            name: key,
            value: '',
            type: getType(key)
         });
         $('.av-value-row:last').after(valueRow);
         $(valueRow).find('input').focus();
      }
   });

   function getType(name) {
      var parts = name.split(' ');
      var typePart = parts.pop();
      switch (typePart) {
         case 'color':
         case 'date':
         case 'datetime':
         case 'time':
         return typePart;
      }
      return 'text';
   }
</script>

<% #value %>
<div class='uk-width-1-2 uk-margin-bottom av-value-row <% param.class %>'>
   <div class='uk-form-label'>
      <span class='av-value-title'><% param.title %></span>
      <a href='javascript:' class='av-value-remove uk-hidden'><i class='uk-icon-trash-o'></i></a>
   </div>
   <div class='uk-form-controls'>
      <input class='uk-width-1-1' type='<% param.type %>' name='<% param.name %>' value='<% param.value %>'>
   </div>
</div>

<% #import %>
<h1><% response.title %></h1>
<form class='uk-form' method="post" enctype="multipart/form-data">
   <% layout.upload upload %>
   <div class='uk-margin-top'>
      <button class='uk-button uk-button-primary' type="submit" id="submit" name="submit" value="1">
         <% gettext Import %>
      </button>
      <a href="." class="uk-button uk-button-link"><% gettext Cancel %></a>
   </div>
</form>

